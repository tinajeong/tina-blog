---
title: 'JVMê³¼ ìë°” ì½”ë“œì˜ ì‹¤í–‰ ë°©ë²•'
thumbSrc: '/static/images/java.png'
date: '2022-06-11'
tags: ['Java','Jvm','jdk','bytecode']
draft: false
summary: 'JVMì„ ì¤‘ì‹¬ìœ¼ë¡œ ì½”ë“œê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ ì •ë¦¬í•©ë‹ˆë‹¤'
images: ['/static/images/java.png']
---

# ğŸ“Œ ëª©ì°¨

![java](/static/images/java.png)

---

# JVMì€ ë¬´ì—‡ì´ë©° ìë°” ì½”ë“œëŠ” ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ”ê°€?
ìë°” ì½”ë“œëŠ” í…ìŠ¤íŠ¸ í˜•íƒœë¡œ ì‘ì„±ëœë‹¤. `.java`ê°€ í™•ì¥ìì´ë‹¤. ì´ `.java` íŒŒì¼ì„ `javac` ëª…ë ¹ì–´ë¥¼ í†µí•´ ìë°” ì»´íŒŒì¼ëŸ¬ê°€ `.class` íŒŒì¼ë¡œ ë³€í™˜í•´ì¤€ë‹¤. 
`.class` íŒŒì¼ì€ íŠ¹ì • CPUì— ì¢…ì†ë˜ëŠ” í˜•íƒœê°€ ì•„ë‹ˆê³ , Bytecodeë¼ëŠ” ì†ŒìŠ¤ì½”ë“œì™€ ê¸°ê³„ì–´ ì¤‘ê°„ ì¯¤ì˜ í˜•íƒœ***intermediate representation***ë¡œ ê¸°ìˆ ë˜ì–´ ìˆë‹¤. 
 
BytecodeëŠ” JVM ì¦‰, **Java Virtual Machine** ***ìë°”ê°€ìƒë¨¸ì‹ ***ì´ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ì‚¬ìš©í•œë‹¤. JVMì€ Bytecodeë¥¼ **OS í™˜ê²½ì— ë§ê²Œ** ì¸ìŠ¤í„´ìŠ¤í™” í•˜ì—¬ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ëŠ” ì—­í• ì„ ë§¡ëŠ”ë‹¤. 

![ì½”ë“œì‹¤í–‰ê³¼ì •](https://images.velog.io/images/maigumi/post/4093d645-d6f0-400f-be51-7242b7c3ccab/image.png)
_ì´ë¯¸ì§€ ì¶œì²˜ : https://docs.oracle.com/javase/tutorial/getStarted/intro/definition.html_

### ì»´íŒŒì¼ ë°©ë²•(ì»¤ë©˜ë“œì°½ì—ì„œ)
ì—¬ê¸° `.java`ê°€ í™•ì¥ìì¸ í…ìŠ¤íŠ¸ íŒŒì¼ì´ ìˆë‹¤.
```java
public class HelloWorld {

        public static void main (String[] args) {
                System.out.println("Hello World!");
        }
}
```

í•´ë‹¹ íŒŒì¼ì„ `javac` ëª…ë ¹ì–´ë¥¼ í†µí•´ ì»´íŒŒì¼ í•  ìˆ˜ ìˆë‹¤. ì»´íŒŒì¼ì„ í•˜ë©´ `HelloWorld.class` íŒŒì¼ì´ ìƒì„±ëœë‹¤. ì—„ë°€íˆ ë§í•˜ë©´ `javac` ëª…ë ¹ì–´ëŠ” front-endì ì¸ ì»´íŒŒì¼ë§Œ í•œë‹¤. ê¸°ê³„ì–´ê°€ ì•„ë‹Œ ë°”ì´íŠ¸ì½”ë“œë¥¼ ìƒì„±í•´ë‚´ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ë˜ì„œ ìë°”ì˜ ë§¥ë½ì—ì„œ ì»´íŒŒì¼ì„ ì˜ë¯¸í•  ë•ŒëŠ” ë‹¨ìˆœí•œ íŒŒì‹±ì´ ì•„ë‹Œ ê¸°ê³„ì–´ë¥¼ ìƒì„±í•˜ëŠ” `JIT Compiler`ë¥¼ ë¨¼ì € ë– ì˜¬ë ¤ì•¼ í•œë‹¤.  

```
$ javac HelloWorld.java
$ ls
HelloWorld.class  HelloWorld.java
```
class íŒŒì¼ì€ ëŒ€ê°• ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì´ì—ˆë‹¤. `javap` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ class íŒŒì¼ì˜ ë‚´ìš©ì„ human readableí•œ í˜•íƒœë¡œ ë³´ì—¬ì¤€ë‹¤.
```
$ javap -c HelloWorld.class
Compiled from "HelloWorld.java"
public class HelloWorld {
  public HelloWorld();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #13                 // String Hello World!
       5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return
}

```
### ì‹¤í–‰ ë°©ë²•
`.class`íŒŒì¼ì´ ìƒì„±ëë‹¤ë©´ `java` ëª…ë ¹ì–´ë¥¼ í†µí•´ JVM ë³´ê³  ì¼ì„ ì‹œì¼œì„œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. 
```
$ java HelloWorld
Hello World!
```

## JVM

### Write once, Run anywhere : Portablity
ì•ì„œ ì–¸ê¸‰í–ˆë“¯ì´, ë°”ì´íŠ¸ì½”ë“œì™€ ìë°”ê°€ìƒë¨¸ì‹ ì€ í•œ í”„ë¡œê·¸ë¨ë§Œ ì§œì„œ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ëŒì•„ê°ˆ ìˆ˜ ìˆëŠ” ì´ì‹ì„±**Portability** ì„ ì‹¤í˜„í•˜ëŠ” ì—­í• ì„ í•œë‹¤. ë˜‘ê°™ì€ ìƒí™©ê³¼ ë§¥ë½ì€ ì•„ë‹ˆì§€ë§Œ, í”„ë¡œì íŠ¸ í•˜ë‚˜ ì§œì„œ ì•ˆë“œë¡œì´ë“œì™€ iOS í™˜ê²½ ëª¨ë‘ì—ì„œ ëŒì•„ê°€ëŠ” ì–´í”Œì„ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ ì„œí¬íŠ¸í•´ì£¼ëŠ” ê¸°ìˆ _Flutter_ì„ ì—°ìƒí•˜ë©´ ì´í•´ê°€ ì‰¬ìš¸ ê²ƒ ê°™ë‹¤.

![JVMì˜ ì—­í• ](https://images.velog.io/images/maigumi/post/f42f2e30-647b-4fd8-a1a6-3f9862fc59f9/image.png)
_ì´ë¯¸ì§€ ì¶œì²˜ : https://docs.oracle.com/javase/tutorial/getStarted/intro/definition.html_

### Just-in-Time Compiler : Runtime Optimization
í”„ë¡œê·¸ë¨ì´ ëŒì•„ê°€ëŠ” ë™ì•ˆ, ìë°” ê°€ìƒ ë¨¸ì‹ ì— í¬í•¨ëœ JIT CompilerëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ê¸°ê³„ì–´ë¡œ ë²ˆì—­í•´ ì‚¬ìš©í•  ë¿ ì•„ë‹ˆë¼, ëŸ°íƒ€ì„ì— ë°œìƒí•˜ëŠ” ê²ƒë“¤ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ì‹¤í–‰ê³¼ì •ì„ ìµœì í™”í•´ì„œ ì„±ëŠ¥ì„ í–¥ìƒ ì‹œí‚¨ë‹¤. ì¦‰, ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê¸°ê³„ì–´ê°€ ìˆë‹¤ë©´ JIT Compilerê°€ ìºì‹±í•´ë‘”ë‹¤. ì´í›„ ì¬ì»´íŒŒì¼í•˜ê³  í•´ë‹¹ ê¸°ê³„ì–´ê°€ ì¬í˜¸ì¶œ ë˜ë©´, ê¸°ê³„ì–´ë¡œ ë‹¤ì‹œ interpretí•˜ëŠ” ê³¼ì •ì—†ì´ ë°”ë¡œ ì‹¤í–‰í•´ ì‚¬ìš©í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ JIT CompilerëŠ” ìºì‹± ë“±ì˜ ì „ëµì„ í†µí•´ runtime optimizationì„ ì„±ì·¨í•¨ìœ¼ë¡œì¨, ì¼ë°˜ì ì¸ interpreterì™€ì˜ ì„±ëŠ¥ì  ì°¨ë³„ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆë‹¤. ê³ ë¡œ ìë°”ë¥¼ ì²˜ìŒ ë°°ìš¸ ë•Œ ìì£¼ ì–¸ê¸‰ë˜ëŠ” *ìë°” ì„±ëŠ¥ ì´ìŠˆ*ëŠ”  Criticalí•˜ê²Œ ê³ ë ¤ë˜ì–´ì•¼ í•  ì •ë„ëŠ” ì•„ë‹ˆë©°, ìƒìš©ì ìœ¼ë¡œ ì“°ì´ê¸°ì— ë¶€ì¡±í•¨ì´ ì—†ë‹¤.

## JVMì˜ êµ¬ì„± ìš”ì†Œ
JVMì€ 3ê°œì˜ ì„œë¸Œì‹œìŠ¤í…œìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤.
### Class Loader
Class LoaderëŠ” ìë°”ì—ì„œì˜ `ë™ì  í´ë˜ìŠ¤ ë¡œë”©`ì„ ë‹´ë‹¹í•œë‹¤. Class LoaderëŠ” íŠ¹ì • í´ë˜ìŠ¤ Aê°€ ì²˜ìŒ ì°¸ì¡°ë  ë•Œ(compile íƒ€ì„ì´ ì•„ë‹Œ runtimeì—) í´ë˜ìŠ¤ Aë¥¼ loadí•˜ê³ , linkí•˜ê³ , initializeí•œë‹¤.  

- ***load*** : BootStrap, Extension, Application 3ê°œì˜ ë¡œë”ê°€ íŠ¹ì • pathì— í¬í•¨ëœ í´ë˜ìŠ¤ë“¤ì„ êµ¬ë¶„í•˜ê³  ë¶„ì—…í•´ ë¡œë”©ì„ í•´ì¤€ë‹¤.
- ***link*** : Bytecode verifierê°€ ìƒì„±ëœ  Bytecodeë¥¼ ê²€ì¦í•œë‹¤(`Verify`). static ë³€ìˆ˜ ë©”ëª¨ë¦¬ê°€ í• ë‹¹ë˜ê³ , default valueë“¤ë¡œ ì±„ì›Œì§„ë‹¤(`Prepare`). logical referenceë“¤ì´ method ì˜ì—­ì˜ original referenceë¡œ ëŒ€ì²´ëœë‹¤(`Resolve`).
- ***initialize*** : staticë³€ìˆ˜ë“¤ì— ì‚¬ìš©ìê°€ í• ë‹¹í•œ original valueê°€ ëŒ€ì…ë˜ê³ , static blockì´ ì‹¤í–‰ëœë‹¤. 


> ğŸ“Œ _ê³ ë¡œ static variableë„ runtime ì¤‘ class loading timeì— ë©”ëª¨ë¦¬ í• ë‹¹ ëœë‹¤.  
> CëŠ” compile timeì— í• ë‹¹ëœë‹¤._


### Runtime Data Area
Runtime Data AreaëŠ” 5ê°œ ìš”ì†Œë¡œ êµ¬ë³„ëœë‹¤. 

- ***Method Area*** : JVMì—ì„œ method areaëŠ” í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ê³ , ê·¸ë ‡ê¸° ë•Œë¬¸ì— method areaì˜ ìì›ë“¤ì€ ê³µìœ ìì›ì´ë©° thread-safeí•˜ì§€ ì•Šë‹¤. method areaì—ëŠ” static variableì„ ë¹„ë¡¯í•œ í´ë˜ìŠ¤ ë ˆë²¨ì˜ ëª¨ë“  ë°ì´í„°ë“¤ì´ ì €ì¥ëœë‹¤.
- ***Heap Area*** : JVMì—ì„œ heap areaë„ í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ëŠ” ê³µìœ ìì›ì´ê³ , thread-safeí•˜ì§€ ì•Šë‹¤. heap areaì—ëŠ” array, object ë“±ì˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ì´ ì €ì¥ëœë‹¤. 
- ***Stack Area*** : ìŠ¤ë ˆë“œ ë³„ë¡œ í•˜ë‚˜ì˜ runtime stackì´ ìƒì„±ë˜ë¯€ë¡œ thread-safeí•˜ë‹¤. ë©”ì†Œë“œ í˜¸ì¶œì´ ë°œìƒí•  ë•Œ ë§ˆë‹¤ stack ë‚´ë¶€ì ìœ¼ë¡œ ì§€ì—­ë³€ìˆ˜, ì‹¤í–‰í•  ì—°ì‚°, exception catch ì •ë³´, ë©”ì†Œë“œ ê´€ë ¨ ì •ë³´ë“¤ì´ ì €ì¥ë˜ëŠ” `Stack Frame`ì´ ìƒì„±ëœë‹¤. 
- ***PC Registers*** : ìŠ¤ë ˆë“œ ë³„ë¡œ PC Registerë“¤ì´ ìƒì„±ë˜ê³ , PC Registerì—ì„œëŠ” í˜„ì¬ ì‘ì—…ì˜ ì£¼ì†Œê°€ ì €ì¥ë˜ê³ , ë‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ ë„˜ì–´ê°€ë©´ ë‹¤ìŒ ì‘ì—…ì˜ ì£¼ì†Œë¡œ ì—…ë°ì´íŠ¸ ëœë‹¤.
- ***Native Method stacks***: ìŠ¤ë ˆë“œ ë³„ë¡œ Native Method stackì´ ìƒì„±ëœë‹¤. `Native method`ëŠ” Javaì—ì„œ ë‹¤ë¥¸ ì–¸ì–´ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í˜¸ì¶œí•´ì„œ ì‚¬ìš©í•˜ê±°ë‚˜, ì´ë¯¸ ì¡´ì¬í•˜ëŠ”  C/C++ í”„ë¡œì íŠ¸ë¥¼ Javaë¡œ í†µí•©í•  ë•Œ ì‚¬ìš©í•œë‹¤.



### Execution Engine
Execution Engineì€ bytecodeì˜ ë‚´ìš©ì´ ì˜¬ë¼ê°„ Runtime Data Areaì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œë‹¤. Execution Engineì—ëŠ” bytecodeë¥¼ one by one ê¸°ê³„ì–´ë¡œ ë²ˆì—­í•˜ëŠ” Intepreterì™€, Interpreterì˜ ë‹¨ì ì„ ê·¹ë³µí•œ JIT Compiler, ì‚¬ìš©ìì˜ ë©”ëª¨ë¦¬ ê´€ë¦¬ ì—†ì´ë„ ì‚¬ìš©ë˜ì§€ ì•Šì€ ìì›ì„ ìë™ í• ë‹¹ í•´ì œí•˜ëŠ” Garbage Collectorë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤.
## JDK vs JRE

JREëŠ” Java Runtime Environmentì˜ ì•½ìë¡œ, ìë°” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ë° í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬, `java` ëª…ë ¹ì–´, JVM ë“±ì„ ì˜ë¯¸í•œë‹¤. í™˜ê²½ì ì¸ ìš”ì†Œì´ê¸° ë•Œë¬¸ì— JREë§Œ ê°€ì§€ê³¤ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ê°œë°œí•  ìˆœ ì—†ë‹¤.

JDKëŠ” Java Development Kitì˜ ì•½ìë¡œ, JRE ë¿ ì•„ë‹ˆë¼ ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ê°œë°œí•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬, `javac` ëª…ë ì–´ ë“±ì„ í¬í•¨í•œë‹¤. ìë°” í”„ë¡œê·¸ë˜ë¨¸ëŠ” JDKë¥¼ ë°›ì•„ ì‚¬ìš©í•œë‹¤. Java 9ë²„ì „ë¶€í„°ëŠ” JREê°€ ë”°ë¡œ ë§Œë“¤ì–´ì§€ì§€ ì•Šê³ , JDKì— íŒ¨í‚¤ì§•ë˜ì–´ ì¶œì‹œë˜ëŠ” ì¤‘ì´ë‹¤. 



### **Reference**

- https://docs.oracle.com/javase/tutorial/getStarted/intro/definition.html
- https://www.oracle.com/java/technologies/architecture-neutral-portable-robust.html#319
- https://stackoverflow.com/questions/1906445/what-is-the-difference-between-jdk-and-jre
- https://dzone.com/articles/jvm-architecture-explained
- https://en.wikipedia.org/wiki/Just-in-time_compilation
- https://www.baeldung.com/java-native
- Java in a Nutshell, 7th Edition
